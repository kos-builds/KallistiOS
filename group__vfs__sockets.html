<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KallistiOS: Sockets</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KallistiOS<span id="projectnumber">&#160;##version##</span>
   </div>
   <div id="projectbrief">Independent SDK for the Sega Dreamcast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__vfs__sockets.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Sockets<div class="ingroups"><a class="el" href="group__vfs.html">Filesystem</a> &raquo; <a class="el" href="group__vfs__drivers.html">Drivers</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>VFS Driver for adding a BSD-sockets-like filesystem.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__sock__flags" id="r_group__sock__flags"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sock__flags.html">Flags</a></td></tr>
<tr class="memdesc:group__sock__flags"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for Socket VFS. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:fs__socket_8h" id="r_fs__socket_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs__socket_8h.html">fs_socket.h</a></td></tr>
<tr class="memdesc:fs__socket_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definitions for a sockets "filesystem". <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnet__socket__t.html">net_socket_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal representation of a socket for fs_socket.  <a href="structnet__socket__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal sockets protocol handler.  <a href="structfs__socket__proto__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga097b7ed656e32436f856d78ea72d7d72" id="r_ga097b7ed656e32436f856d78ea72d7d72"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sockets.html#ga097b7ed656e32436f856d78ea72d7d72">FS_SOCKET_PROTO_ENTRY</a>&#160;&#160;&#160;{ NULL, NULL }</td></tr>
<tr class="memdesc:ga097b7ed656e32436f856d78ea72d7d72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializer for the entry field in the <a class="el" href="structfs__socket__proto__t.html" title="Internal sockets protocol handler.">fs_socket_proto_t</a> struct.  <br /></td></tr>
<tr class="separator:ga097b7ed656e32436f856d78ea72d7d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga59210fb2e2589dc9cfc32085239320e8" id="r_ga59210fb2e2589dc9cfc32085239320e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnet__socket__t.html">net_socket_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sockets.html#ga59210fb2e2589dc9cfc32085239320e8">fs_socket_open_sock</a> (<a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a> *proto)</td></tr>
<tr class="memdesc:ga59210fb2e2589dc9cfc32085239320e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a socket without calling the protocol initializer.  <br /></td></tr>
<tr class="separator:ga59210fb2e2589dc9cfc32085239320e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29f23e1a12915ead3103c990ba151bb5" id="r_ga29f23e1a12915ead3103c990ba151bb5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sockets.html#ga29f23e1a12915ead3103c990ba151bb5">fs_socket_input</a> (<a class="el" href="structnetif__t.html">netif_t</a> *src, int domain, int protocol, const void *hdr, const <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> *data, size_t size)</td></tr>
<tr class="memdesc:ga29f23e1a12915ead3103c990ba151bb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input a packet into some socket family handler.  <br /></td></tr>
<tr class="separator:ga29f23e1a12915ead3103c990ba151bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fd5572c54f1300b2ed6ddae855f8629" id="r_ga6fd5572c54f1300b2ed6ddae855f8629"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sockets.html#ga6fd5572c54f1300b2ed6ddae855f8629">fs_socket_proto_add</a> (<a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a> *proto)</td></tr>
<tr class="memdesc:ga6fd5572c54f1300b2ed6ddae855f8629"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new protocol for use with fs_socket.  <br /></td></tr>
<tr class="separator:ga6fd5572c54f1300b2ed6ddae855f8629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga385292f1e99c1e227216803f5674b784" id="r_ga385292f1e99c1e227216803f5674b784"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vfs__sockets.html#ga385292f1e99c1e227216803f5674b784">fs_socket_proto_remove</a> (<a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a> *proto)</td></tr>
<tr class="memdesc:ga385292f1e99c1e227216803f5674b784"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister a protocol from fs_socket.  <br /></td></tr>
<tr class="separator:ga385292f1e99c1e227216803f5674b784"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>VFS Driver for adding a BSD-sockets-like filesystem. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga097b7ed656e32436f856d78ea72d7d72" name="ga097b7ed656e32436f856d78ea72d7d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga097b7ed656e32436f856d78ea72d7d72">&#9670;&#160;</a></span>FS_SOCKET_PROTO_ENTRY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FS_SOCKET_PROTO_ENTRY&#160;&#160;&#160;{ NULL, NULL }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializer for the entry field in the <a class="el" href="structfs__socket__proto__t.html" title="Internal sockets protocol handler.">fs_socket_proto_t</a> struct. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga29f23e1a12915ead3103c990ba151bb5" name="ga29f23e1a12915ead3103c990ba151bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29f23e1a12915ead3103c990ba151bb5">&#9670;&#160;</a></span>fs_socket_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_socket_input </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetif__t.html">netif_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__system__types.html#gadde6aaee8457bee49c2a92621fe22b79">uint8</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input a packet into some socket family handler. </p>
<p>This function is used by the lower-level network protocol handlers to input packets for further processing by upper-level protocols. This will call the input function on the family handler, if one is found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>The network interface the packet came in on </td></tr>
    <tr><td class="paramname">domain</td><td>The low-level protocol used (AF_INET or AF_INET6) </td></tr>
    <tr><td class="paramname">protocol</td><td>The upper-level protocol that we're looking for </td></tr>
    <tr><td class="paramname">hdr</td><td>The low-level protocol header </td></tr>
    <tr><td class="paramname">data</td><td>The upper-level packet, without any lower-level protocol headers, but with the upper-level ones intact </td></tr>
    <tr><td class="paramname">size</td><td>The size of the packet (the data parameter)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-2</td><td>The protocol is not known </td></tr>
    <tr><td class="paramname">-1</td><td>Protocol-level error processing packet </td></tr>
    <tr><td class="paramname">0</td><td>On success </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga59210fb2e2589dc9cfc32085239320e8" name="ga59210fb2e2589dc9cfc32085239320e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59210fb2e2589dc9cfc32085239320e8">&#9670;&#160;</a></span>fs_socket_open_sock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnet__socket__t.html">net_socket_t</a> * fs_socket_open_sock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a> *&#160;</td>
          <td class="paramname"><em>proto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open a socket without calling the protocol initializer. </p>
<p>This function creates a new socket, but does not call the protocol's <a class="el" href="group__networking__sockets.html#gaf4e0711877c45a41168ac677b0670ccd" title="Create an endpoint for communications.">socket()</a> function. This is meant to be used for things like accepting an incoming connection, where calling the regular socket initializer could cause issues. You shouldn't really have any need to call this function unless you are implementing a new protocol handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>The protocol to use for the socket.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The newly created socket on success, NULL on failure.</dd></dl>
<dl class="section user"><dt>Error Conditions:</dt><dd><em>EWOULDBLOCK</em> - if the function would block in an IRQ <br  />
<em>ENOMEM</em> - out of memory <br  />
<em>EMFILE</em> - too many files open </dd></dl>

</div>
</div>
<a id="ga6fd5572c54f1300b2ed6ddae855f8629" name="ga6fd5572c54f1300b2ed6ddae855f8629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6fd5572c54f1300b2ed6ddae855f8629">&#9670;&#160;</a></span>fs_socket_proto_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_socket_proto_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a> *&#160;</td>
          <td class="paramname"><em>proto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new protocol for use with fs_socket. </p>
<p>This function registers a protocol handler with fs_socket for use when creating and using sockets. This protocol handler must implement all of the functions in the <a class="el" href="structfs__socket__proto__t.html" title="Internal sockets protocol handler.">fs_socket_proto_t</a> structure. See the code in kos/kernel/net/net_udp.c for an example of how to do this.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function is NOT safe to call inside an interrupt.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>The new protocol handler to register</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success (no error conditions are currently defined) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga385292f1e99c1e227216803f5674b784" name="ga385292f1e99c1e227216803f5674b784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga385292f1e99c1e227216803f5674b784">&#9670;&#160;</a></span>fs_socket_proto_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fs_socket_proto_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfs__socket__proto__t.html">fs_socket_proto_t</a> *&#160;</td>
          <td class="paramname"><em>proto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister a protocol from fs_socket. </p>
<p>This function does the exact opposite of fs_socket_proto_add, and removes a protocol from use with fs_socket.</p>
<dl class="section note"><dt>Note</dt><dd>It is the programmer's responsibility to make sure that no sockets are still around that are registered with the protocol to be removed (as they will not work properly once the handler has been removed).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>The protocol handler to remove</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>On error (This function does not directly change errno) </td></tr>
    <tr><td class="paramname">0</td><td>On success </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
