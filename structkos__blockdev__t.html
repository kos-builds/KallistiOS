<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KallistiOS: kos_blockdev_t Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KallistiOS<span id="projectnumber">&#160;##version##</span>
   </div>
   <div id="projectbrief">Independent SDK for the Sega Dreamcast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structkos__blockdev__t.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">kos_blockdev_t Struct Reference<div class="ingroups"><a class="el" href="group__vfs.html">Filesystem</a> &raquo; <a class="el" href="group__vfs__drivers.html">Drivers</a> &raquo; <a class="el" href="group__vfs__blockdev.html">Block Devices</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>A simple block device.  
 <a href="structkos__blockdev__t.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="blockdev_8h_source.html">kos/blockdev.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a685dc3881f8f1e9d81e4766606f1ba38" id="r_a685dc3881f8f1e9d81e4766606f1ba38"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#a685dc3881f8f1e9d81e4766606f1ba38">dev_data</a></td></tr>
<tr class="memdesc:a685dc3881f8f1e9d81e4766606f1ba38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal device data.  <br /></td></tr>
<tr class="separator:a685dc3881f8f1e9d81e4766606f1ba38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8527cf139ee36136425de5e583248904" id="r_a8527cf139ee36136425de5e583248904"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#a8527cf139ee36136425de5e583248904">l_block_size</a></td></tr>
<tr class="memdesc:a8527cf139ee36136425de5e583248904"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log base 2 of the bytes per block.  <br /></td></tr>
<tr class="separator:a8527cf139ee36136425de5e583248904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96313e260e6a6c7c7208184c26c790ab" id="r_a96313e260e6a6c7c7208184c26c790ab"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#a96313e260e6a6c7c7208184c26c790ab">init</a> )(struct kos_blockdev *d)</td></tr>
<tr class="memdesc:a96313e260e6a6c7c7208184c26c790ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the block device.  <br /></td></tr>
<tr class="separator:a96313e260e6a6c7c7208184c26c790ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecdb7ac36ea5233bebf43abd273bf6f3" id="r_aecdb7ac36ea5233bebf43abd273bf6f3"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#aecdb7ac36ea5233bebf43abd273bf6f3">shutdown</a> )(struct kos_blockdev *d)</td></tr>
<tr class="memdesc:aecdb7ac36ea5233bebf43abd273bf6f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shut down the block device.  <br /></td></tr>
<tr class="separator:aecdb7ac36ea5233bebf43abd273bf6f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad92d59ce8d231675a1226846875992df" id="r_ad92d59ce8d231675a1226846875992df"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#ad92d59ce8d231675a1226846875992df">read_blocks</a> )(struct kos_blockdev *d, uint64_t block, size_t count, void *buf)</td></tr>
<tr class="memdesc:ad92d59ce8d231675a1226846875992df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a number of blocks from the device.  <br /></td></tr>
<tr class="separator:ad92d59ce8d231675a1226846875992df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670113bcd3b833064ef5057d04d82973" id="r_a670113bcd3b833064ef5057d04d82973"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#a670113bcd3b833064ef5057d04d82973">write_blocks</a> )(struct kos_blockdev *d, uint64_t block, size_t count, const void *buf)</td></tr>
<tr class="memdesc:a670113bcd3b833064ef5057d04d82973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a number of blocks to the device.  <br /></td></tr>
<tr class="separator:a670113bcd3b833064ef5057d04d82973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758a01cf5388b340246ff1d558016ab3" id="r_a758a01cf5388b340246ff1d558016ab3"><td class="memItemLeft" align="right" valign="top">uint64_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#a758a01cf5388b340246ff1d558016ab3">count_blocks</a> )(struct kos_blockdev *d)</td></tr>
<tr class="memdesc:a758a01cf5388b340246ff1d558016ab3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count the number of blocks on the device.  <br /></td></tr>
<tr class="separator:a758a01cf5388b340246ff1d558016ab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e841045d47bd582ab946f051482de05" id="r_a1e841045d47bd582ab946f051482de05"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkos__blockdev__t.html#a1e841045d47bd582ab946f051482de05">flush</a> )(struct kos_blockdev *d)</td></tr>
<tr class="memdesc:a1e841045d47bd582ab946f051482de05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush the write cache (if any) of the device.  <br /></td></tr>
<tr class="separator:a1e841045d47bd582ab946f051482de05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simple block device. </p>
<p>This structure represents a single block device. Each block device should be associated with exactly one filesystem and is used to actually read the data from the disk (or other device) where it is stored.</p>
<p>By using a block device with any new filesystems, we can abstract away a few things so that filesystems can be used with a variety of different "devices", such as the SD card reader for the Dreamcast or a disk image file of some sort. </p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a758a01cf5388b340246ff1d558016ab3" name="a758a01cf5388b340246ff1d558016ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a758a01cf5388b340246ff1d558016ab3">&#9670;&#160;</a></span>count_blocks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t(* kos_blockdev_t::count_blocks) (struct kos_blockdev *d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Count the number of blocks on the device. </p>
<p>This function should return the total number of blocks on the device. There is no expectation of the device to keep track of which blocks are in use or anything else of the sort.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The device to read the block count from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of blocks that the device has. </dd></dl>

</div>
</div>
<a id="a685dc3881f8f1e9d81e4766606f1ba38" name="a685dc3881f8f1e9d81e4766606f1ba38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685dc3881f8f1e9d81e4766606f1ba38">&#9670;&#160;</a></span>dev_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* kos_blockdev_t::dev_data</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Internal device data. </p>

</div>
</div>
<a id="a1e841045d47bd582ab946f051482de05" name="a1e841045d47bd582ab946f051482de05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e841045d47bd582ab946f051482de05">&#9670;&#160;</a></span>flush</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* kos_blockdev_t::flush) (struct kos_blockdev *d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flush the write cache (if any) of the device. </p>
<p>This function shall signal to the device that any write caches that are present on the device shall be flushed so that all data written to this point shall persist to the underlying storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The device to flush caches on. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. Set errno as appropriate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a96313e260e6a6c7c7208184c26c790ab" name="a96313e260e6a6c7c7208184c26c790ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96313e260e6a6c7c7208184c26c790ab">&#9670;&#160;</a></span>init</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* kos_blockdev_t::init) (struct kos_blockdev *d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the block device. </p>
<p>This function should do any necessary initialization to use the block device passed in.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The device to initialize. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. Set errno as appropriate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8527cf139ee36136425de5e583248904" name="a8527cf139ee36136425de5e583248904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8527cf139ee36136425de5e583248904">&#9670;&#160;</a></span>l_block_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t kos_blockdev_t::l_block_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log base 2 of the bytes per block. </p>

</div>
</div>
<a id="ad92d59ce8d231675a1226846875992df" name="ad92d59ce8d231675a1226846875992df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad92d59ce8d231675a1226846875992df">&#9670;&#160;</a></span>read_blocks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* kos_blockdev_t::read_blocks) (struct kos_blockdev *d, uint64_t block, size_t count, void *buf)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a number of blocks from the device. </p>
<p>This function should read the specified number of device blocks into the given buffer. The buffer will already be allocated by the caller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The device to read from. </td></tr>
    <tr><td class="paramname">block</td><td>The first block to read. </td></tr>
    <tr><td class="paramname">count</td><td>The number of blocks to read. </td></tr>
    <tr><td class="paramname">buf</td><td>The buffer to read into. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. Set errno as appropriate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aecdb7ac36ea5233bebf43abd273bf6f3" name="aecdb7ac36ea5233bebf43abd273bf6f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecdb7ac36ea5233bebf43abd273bf6f3">&#9670;&#160;</a></span>shutdown</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* kos_blockdev_t::shutdown) (struct kos_blockdev *d)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shut down the block device. </p>
<p>This function should do any teardown work that is needed to clean up the block device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The device to shut down. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. Set errno as appropriate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a670113bcd3b833064ef5057d04d82973" name="a670113bcd3b833064ef5057d04d82973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a670113bcd3b833064ef5057d04d82973">&#9670;&#160;</a></span>write_blocks</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* kos_blockdev_t::write_blocks) (struct kos_blockdev *d, uint64_t block, size_t count, const void *buf)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a number of blocks to the device. </p>
<p>This function should write the specified number of device blocks onto the device from the given buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>The device to write to. </td></tr>
    <tr><td class="paramname">block</td><td>The first block to write. </td></tr>
    <tr><td class="paramname">count</td><td>The number of blocks to write. </td></tr>
    <tr><td class="paramname">buf</td><td>The buffer to write from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. Set errno as appropriate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>include/kos/<a class="el" href="blockdev_8h_source.html">blockdev.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structkos__blockdev__t.html">kos_blockdev_t</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
