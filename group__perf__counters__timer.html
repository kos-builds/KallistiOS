<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KallistiOS: Timer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KallistiOS<span id="projectnumber">&#160;##version##</span>
   </div>
   <div id="projectbrief">Independent SDK for the Sega Dreamcast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__perf__counters__timer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Timer<div class="ingroups"><a class="el" href="group__debugging.html">Debugging</a> &raquo; <a class="el" href="group__perf__counters.html">Performance Counters</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>High-resolution performance counter-based timer API.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3ee50187ccc93ee4d357c15963294db8" id="r_ga3ee50187ccc93ee4d357c15963294db8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__perf__counters__timer.html#ga3ee50187ccc93ee4d357c15963294db8">perf_cntr_timer_enable</a> (void)</td></tr>
<tr class="memdesc:ga3ee50187ccc93ee4d357c15963294db8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable the nanosecond timer.  <br /></td></tr>
<tr class="separator:ga3ee50187ccc93ee4d357c15963294db8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1212e8e6cae9487376fcc4a2242abcc" id="r_gad1212e8e6cae9487376fcc4a2242abcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__perf__counters__timer.html#gad1212e8e6cae9487376fcc4a2242abcc">perf_cntr_timer_disable</a> (void)</td></tr>
<tr class="memdesc:gad1212e8e6cae9487376fcc4a2242abcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the nanosecond timer.  <br /></td></tr>
<tr class="separator:gad1212e8e6cae9487376fcc4a2242abcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7016a0952e1313c909f57706869e629" id="r_gaf7016a0952e1313c909f57706869e629"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__perf__counters__timer.html#gaf7016a0952e1313c909f57706869e629">perf_cntr_timer_enabled</a> (void)</td></tr>
<tr class="memdesc:gaf7016a0952e1313c909f57706869e629"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the nanosecond timer is enabled.  <br /></td></tr>
<tr class="separator:gaf7016a0952e1313c909f57706869e629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga358fcfefcb2d36710d6cfeb7c97ff77f" id="r_ga358fcfefcb2d36710d6cfeb7c97ff77f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__perf__counters__timer.html#ga358fcfefcb2d36710d6cfeb7c97ff77f">perf_cntr_timer_ns</a> (void)</td></tr>
<tr class="memdesc:ga358fcfefcb2d36710d6cfeb7c97ff77f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets elapsed CPU time (in nanoseconds)  <br /></td></tr>
<tr class="separator:ga358fcfefcb2d36710d6cfeb7c97ff77f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>High-resolution performance counter-based timer API. </p>
<p>This API allows for using the performance counters as high-resolution general-purpose interval timer with 5ns ticks. It does this by configuring <a class="el" href="group__perf__counters.html#ggac42853e8d8d4bcd6f7bfb993c0fb11b8a115020c18121ce6871bdfde8c44ec742">PRFC0</a> in <a class="el" href="group__perf__counters.html#gga31675ab20e99e7e50db03368a3c390c1a2d2039e8b45ab2deff8916d1cd79289c">PMCR_ELAPSED_TIME_MODE</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This is enabled by default. To use <a class="el" href="group__perf__counters.html#ggac42853e8d8d4bcd6f7bfb993c0fb11b8a115020c18121ce6871bdfde8c44ec742">PRFC0</a> for something else, either use <a class="el" href="group__perf__counters__timer.html#gad1212e8e6cae9487376fcc4a2242abcc" title="Disable the nanosecond timer.">perf_cntr_timer_disable()</a> or <a class="el" href="group__perf__counters.html#ga175e01a5d7d4dc35b02bc1305ff4af97" title="Start a performance counter.">perf_cntr_start()</a> to reconfigure it for something else. When disabled, the timer will simply fall through to use <a class="el" href="group__tmu__uptime.html#ga5fabed88202024c5b5ea7ac711e2d8fb" title="Get the current uptime of the system (in nanoseconds).">timer_ns_gettime64()</a> from the timer driver, decreasing the resolution of each tick to 80ns.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The performance counter timer is only counting <em>active</em> CPU cycles. This means that when KOS's thread scheduler uses the "sleep" instruction, putting the CPU to sleep, these counters cease to record elapsed time. Because of this, they should only be used to measure small deltas that are not across frames, when you want real wall time rather than active CPU time.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__timers.html" title="SH4 CPU peripheral providing timers and counters.">Timer Unit</a> </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gad1212e8e6cae9487376fcc4a2242abcc" name="gad1212e8e6cae9487376fcc4a2242abcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad1212e8e6cae9487376fcc4a2242abcc">&#9670;&#160;</a></span>perf_cntr_timer_disable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void perf_cntr_timer_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable the nanosecond timer. </p>
<p>This function disables the performance counter used for the <a class="el" href="group__perf__counters__timer.html#ga358fcfefcb2d36710d6cfeb7c97ff77f" title="Gets elapsed CPU time (in nanoseconds)">perf_cntr_timer_ns()</a> function.</p>
<dl class="section note"><dt>Note</dt><dd>Generally, you will not want to do this, unless you have some need to use the counter <a class="el" href="group__perf__counters.html#ggac42853e8d8d4bcd6f7bfb993c0fb11b8a115020c18121ce6871bdfde8c44ec742">PRFC0</a> for something else. </dd></dl>

</div>
</div>
<a id="ga3ee50187ccc93ee4d357c15963294db8" name="ga3ee50187ccc93ee4d357c15963294db8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ee50187ccc93ee4d357c15963294db8">&#9670;&#160;</a></span>perf_cntr_timer_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void perf_cntr_timer_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable the nanosecond timer. </p>
<p>This function enables the performance counter used for the <a class="el" href="group__perf__counters__timer.html#ga358fcfefcb2d36710d6cfeb7c97ff77f" title="Gets elapsed CPU time (in nanoseconds)">perf_cntr_timer_ns()</a> function.</p>
<dl class="section note"><dt>Note</dt><dd>This is on by default. The function uses <a class="el" href="group__perf__counters.html#ggac42853e8d8d4bcd6f7bfb993c0fb11b8a115020c18121ce6871bdfde8c44ec742">PRFC0</a> to do the work.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The performance counters are only counting <em>active</em> CPU cycles while in this mode. This is analogous to providing you with the CPU time of your application, not the actual wall-time or monotonic clock, as it ceases to count when the kernel puts the CPU to sleep. </dd></dl>

</div>
</div>
<a id="gaf7016a0952e1313c909f57706869e629" name="gaf7016a0952e1313c909f57706869e629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf7016a0952e1313c909f57706869e629">&#9670;&#160;</a></span>perf_cntr_timer_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool perf_cntr_timer_enabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether the nanosecond timer is enabled. </p>
<p>Queries the configuration of <a class="el" href="group__perf__counters.html#ggac42853e8d8d4bcd6f7bfb993c0fb11b8a115020c18121ce6871bdfde8c44ec742">PRFC0</a> to check whether it's currently acting as the nanosecond timer.</p>
<dl class="section note"><dt>Note</dt><dd>Even when it's not, <a class="el" href="group__perf__counters__timer.html#ga358fcfefcb2d36710d6cfeb7c97ff77f" title="Gets elapsed CPU time (in nanoseconds)">perf_cntr_timer_ns()</a> will still gracefully fall-through to using the <a class="el" href="group__tmu__uptime.html#ga5fabed88202024c5b5ea7ac711e2d8fb" title="Get the current uptime of the system (in nanoseconds).">timer_ns_gettime64()</a>, which decreases the resolution of each tick to 80ns.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The nanosecond timer is configured and running </td></tr>
    <tr><td class="paramname">false</td><td>The nanosecond timer is not configured and/or isn't running </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga358fcfefcb2d36710d6cfeb7c97ff77f" name="ga358fcfefcb2d36710d6cfeb7c97ff77f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga358fcfefcb2d36710d6cfeb7c97ff77f">&#9670;&#160;</a></span>perf_cntr_timer_ns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t perf_cntr_timer_ns </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets elapsed CPU time (in nanoseconds) </p>
<p>This function retrieves the total amount of <em>active</em> CPU time since <a class="el" href="group__perf__counters__timer.html#gaf7016a0952e1313c909f57706869e629" title="Check whether the nanosecond timer is enabled.">perf_cntr_timer_enabled()</a> was called.</p>
<dl class="section note"><dt>Note</dt><dd>It's called by default when KOS initializes, so unless you reinitialize it later on, this should be the total CPU time since KOS booted up.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The number of nanoseconds of active CPU time since the timer was enabled. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
