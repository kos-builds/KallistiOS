<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KallistiOS: kernel/arch/dreamcast/include/arch/mmu.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KallistiOS<span id="projectnumber">&#160;##version##</span>
   </div>
   <div id="projectbrief">Independent SDK for the Sega Dreamcast</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mmu_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mmu.h File Reference<div class="ingroups"><a class="el" href="group__system.html">System</a> &raquo; <a class="el" href="group__mmu.html">MMU</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Memory Management Unit and Translation Lookaside Buffer handling.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;sys/cdefs.h&gt;</code><br />
<code>#include &lt;<a class="el" href="types_8h_source.html">arch/types.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="uio_8h_source.html">sys/uio.h</a>&gt;</code><br />
</div>
<p><a href="mmu_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmmupage__t.html">mmupage_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MMU TLB entry for a single page.  <a href="structmmupage__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmmusubcontext__t.html">mmusubcontext_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MMU sub-context type.  <a href="structmmusubcontext__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmmucontext__t.html">mmucontext_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MMU context type.  <a href="structmmucontext__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaa627e16a878bf898eea19766a93b18e1" id="r_gaa627e16a878bf898eea19766a93b18e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#gaa627e16a878bf898eea19766a93b18e1">MMU_TOP_SHIFT</a>&#160;&#160;&#160;21</td></tr>
<tr class="memdesc:gaa627e16a878bf898eea19766a93b18e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Top-level shift.  <br /></td></tr>
<tr class="separator:gaa627e16a878bf898eea19766a93b18e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24c05c93731901e5f132e67feee29ed0" id="r_ga24c05c93731901e5f132e67feee29ed0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga24c05c93731901e5f132e67feee29ed0">MMU_TOP_BITS</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:ga24c05c93731901e5f132e67feee29ed0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Top-level bits.  <br /></td></tr>
<tr class="separator:ga24c05c93731901e5f132e67feee29ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61b88dd6dcd16e1ad31cb5a0353c9bd2" id="r_ga61b88dd6dcd16e1ad31cb5a0353c9bd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga61b88dd6dcd16e1ad31cb5a0353c9bd2">MMU_TOP_MASK</a>&#160;&#160;&#160;((1 &lt;&lt; <a class="el" href="group__mmu__bit__macros.html#ga24c05c93731901e5f132e67feee29ed0">MMU_TOP_BITS</a>) - 1)</td></tr>
<tr class="memdesc:ga61b88dd6dcd16e1ad31cb5a0353c9bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Top-level mask.  <br /></td></tr>
<tr class="separator:ga61b88dd6dcd16e1ad31cb5a0353c9bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f1371656815d14851c7632137c468c6" id="r_ga8f1371656815d14851c7632137c468c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga8f1371656815d14851c7632137c468c6">MMU_BOT_SHIFT</a>&#160;&#160;&#160;12</td></tr>
<tr class="memdesc:ga8f1371656815d14851c7632137c468c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bottom shift.  <br /></td></tr>
<tr class="separator:ga8f1371656815d14851c7632137c468c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8bbd592b1cc38fbed948ee3b655fd8d1" id="r_ga8bbd592b1cc38fbed948ee3b655fd8d1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga8bbd592b1cc38fbed948ee3b655fd8d1">MMU_BOT_BITS</a>&#160;&#160;&#160;9</td></tr>
<tr class="memdesc:ga8bbd592b1cc38fbed948ee3b655fd8d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bottom bits.  <br /></td></tr>
<tr class="separator:ga8bbd592b1cc38fbed948ee3b655fd8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63d493679e41564015f07a9c3def4537" id="r_ga63d493679e41564015f07a9c3def4537"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga63d493679e41564015f07a9c3def4537">MMU_BOT_MASK</a>&#160;&#160;&#160;((1 &lt;&lt; <a class="el" href="group__mmu__bit__macros.html#ga8bbd592b1cc38fbed948ee3b655fd8d1">MMU_BOT_BITS</a>) - 1)</td></tr>
<tr class="memdesc:ga63d493679e41564015f07a9c3def4537"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bottom mask.  <br /></td></tr>
<tr class="separator:ga63d493679e41564015f07a9c3def4537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga775b72d617567642b5578f594ce83638" id="r_ga775b72d617567642b5578f594ce83638"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga775b72d617567642b5578f594ce83638">MMU_IND_SHIFT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga775b72d617567642b5578f594ce83638"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index shift.  <br /></td></tr>
<tr class="separator:ga775b72d617567642b5578f594ce83638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c2625f4bb966e269b405e24159ab9f7" id="r_ga9c2625f4bb966e269b405e24159ab9f7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#ga9c2625f4bb966e269b405e24159ab9f7">MMU_IND_BITS</a>&#160;&#160;&#160;12</td></tr>
<tr class="memdesc:ga9c2625f4bb966e269b405e24159ab9f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index bits.  <br /></td></tr>
<tr class="separator:ga9c2625f4bb966e269b405e24159ab9f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa541ddb4beb8b7378a261e67b3e28f9c" id="r_gaa541ddb4beb8b7378a261e67b3e28f9c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__bit__macros.html#gaa541ddb4beb8b7378a261e67b3e28f9c">MMU_IND_MASK</a>&#160;&#160;&#160;((1 &lt;&lt; <a class="el" href="group__mmu__bit__macros.html#ga9c2625f4bb966e269b405e24159ab9f7">MMU_IND_BITS</a>) - 1)</td></tr>
<tr class="memdesc:gaa541ddb4beb8b7378a261e67b3e28f9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index mask.  <br /></td></tr>
<tr class="separator:gaa541ddb4beb8b7378a261e67b3e28f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ea26a2af1f5c77c800d04bcbd2b9f4e" id="r_ga3ea26a2af1f5c77c800d04bcbd2b9f4e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__prot__values.html#ga3ea26a2af1f5c77c800d04bcbd2b9f4e">MMU_KERNEL_RDONLY</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga3ea26a2af1f5c77c800d04bcbd2b9f4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">No user access, kernel read-only.  <br /></td></tr>
<tr class="separator:ga3ea26a2af1f5c77c800d04bcbd2b9f4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad26df705dc75a83e024c260d6e2aec98" id="r_gad26df705dc75a83e024c260d6e2aec98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__prot__values.html#gad26df705dc75a83e024c260d6e2aec98">MMU_KERNEL_RDWR</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gad26df705dc75a83e024c260d6e2aec98"><td class="mdescLeft">&#160;</td><td class="mdescRight">No user access, kernel full.  <br /></td></tr>
<tr class="separator:gad26df705dc75a83e024c260d6e2aec98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga41bb197fa6677f3568b4d965c3b89379" id="r_ga41bb197fa6677f3568b4d965c3b89379"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__prot__values.html#ga41bb197fa6677f3568b4d965c3b89379">MMU_ALL_RDONLY</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga41bb197fa6677f3568b4d965c3b89379"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read-only user and kernel.  <br /></td></tr>
<tr class="separator:ga41bb197fa6677f3568b4d965c3b89379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae62e749b994950ccb572af032eecf0c4" id="r_gae62e749b994950ccb572af032eecf0c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__prot__values.html#gae62e749b994950ccb572af032eecf0c4">MMU_ALL_RDWR</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:gae62e749b994950ccb572af032eecf0c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full access, user and kernel.  <br /></td></tr>
<tr class="separator:gae62e749b994950ccb572af032eecf0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf4cf8c3d986bdfbf8e5581e18c31c5d1" id="r_gaf4cf8c3d986bdfbf8e5581e18c31c5d1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__cache__values.html#gaf4cf8c3d986bdfbf8e5581e18c31c5d1">MMU_NO_CACHE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gaf4cf8c3d986bdfbf8e5581e18c31c5d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache disabled.  <br /></td></tr>
<tr class="separator:gaf4cf8c3d986bdfbf8e5581e18c31c5d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f709d91408e6b182f6e00909c8157c1" id="r_ga2f709d91408e6b182f6e00909c8157c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__cache__values.html#ga2f709d91408e6b182f6e00909c8157c1">MMU_CACHE_BACK</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga2f709d91408e6b182f6e00909c8157c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write-back caching.  <br /></td></tr>
<tr class="separator:ga2f709d91408e6b182f6e00909c8157c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b6ea225f16824b575b0a818139ac812" id="r_ga7b6ea225f16824b575b0a818139ac812"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__cache__values.html#ga7b6ea225f16824b575b0a818139ac812">MMU_CACHE_WT</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ga7b6ea225f16824b575b0a818139ac812"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write-through caching.  <br /></td></tr>
<tr class="separator:ga7b6ea225f16824b575b0a818139ac812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a51823b12d7f81261bea0b49f324417" id="r_ga4a51823b12d7f81261bea0b49f324417"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu__cache__values.html#ga4a51823b12d7f81261bea0b49f324417">MMU_CACHEABLE</a>&#160;&#160;&#160;<a class="el" href="group__mmu__cache__values.html#ga2f709d91408e6b182f6e00909c8157c1">MMU_CACHE_BACK</a></td></tr>
<tr class="memdesc:ga4a51823b12d7f81261bea0b49f324417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default caching.  <br /></td></tr>
<tr class="separator:ga4a51823b12d7f81261bea0b49f324417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1da93d07c858b66f16d8fb8d55bfc309" id="r_ga1da93d07c858b66f16d8fb8d55bfc309"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga1da93d07c858b66f16d8fb8d55bfc309">MMU_SUB_PAGES</a>&#160;&#160;&#160;512</td></tr>
<tr class="memdesc:ga1da93d07c858b66f16d8fb8d55bfc309"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of pages in a sub-context.  <br /></td></tr>
<tr class="separator:ga1da93d07c858b66f16d8fb8d55bfc309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4944d4b6e4f2b102060cb6e71cd15945" id="r_a4944d4b6e4f2b102060cb6e71cd15945"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmu_8h.html#a4944d4b6e4f2b102060cb6e71cd15945">MMU_PAGES</a>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:a4944d4b6e4f2b102060cb6e71cd15945"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of sub-contexts in the main level context.  <br /></td></tr>
<tr class="separator:a4944d4b6e4f2b102060cb6e71cd15945"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga85804e94e2c6f22c8d1d1f2c216ba0d1" id="r_ga85804e94e2c6f22c8d1d1f2c216ba0d1"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structmmupage__t.html">mmupage_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga85804e94e2c6f22c8d1d1f2c216ba0d1">mmu_mapfunc_t</a>) (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context, int virtpage)</td></tr>
<tr class="memdesc:ga85804e94e2c6f22c8d1d1f2c216ba0d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">MMU mapping handler.  <br /></td></tr>
<tr class="separator:ga85804e94e2c6f22c8d1d1f2c216ba0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga99345af516a0d915069901fd4d2a8582" id="r_ga99345af516a0d915069901fd4d2a8582"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga99345af516a0d915069901fd4d2a8582">mmu_use_table</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context)</td></tr>
<tr class="memdesc:ga99345af516a0d915069901fd4d2a8582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the "current" page tables for TLB handling.  <br /></td></tr>
<tr class="separator:ga99345af516a0d915069901fd4d2a8582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c300b842e699577ec52b05215ff497a" id="r_ga8c300b842e699577ec52b05215ff497a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmmucontext__t.html">mmucontext_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga8c300b842e699577ec52b05215ff497a">mmu_context_create</a> (int asid)</td></tr>
<tr class="memdesc:ga8c300b842e699577ec52b05215ff497a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new MMU context.  <br /></td></tr>
<tr class="separator:ga8c300b842e699577ec52b05215ff497a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00ee028bb7e383e6a478d9c0bc38e394" id="r_ga00ee028bb7e383e6a478d9c0bc38e394"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga00ee028bb7e383e6a478d9c0bc38e394">mmu_context_destroy</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context)</td></tr>
<tr class="memdesc:ga00ee028bb7e383e6a478d9c0bc38e394"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy an MMU context when a process is being destroyed.  <br /></td></tr>
<tr class="separator:ga00ee028bb7e383e6a478d9c0bc38e394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7bc7e2e50dc71075798502ee3f49f62" id="r_gaa7bc7e2e50dc71075798502ee3f49f62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gaa7bc7e2e50dc71075798502ee3f49f62">mmu_virt_to_phys</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context, int virtpage)</td></tr>
<tr class="memdesc:gaa7bc7e2e50dc71075798502ee3f49f62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Using the given page tables, translate the virtual page ID to a physical page ID.  <br /></td></tr>
<tr class="separator:gaa7bc7e2e50dc71075798502ee3f49f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga51602d6eff020251832042618d493ea5" id="r_ga51602d6eff020251832042618d493ea5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga51602d6eff020251832042618d493ea5">mmu_phys_to_virt</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context, int physpage)</td></tr>
<tr class="memdesc:ga51602d6eff020251832042618d493ea5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Using the given page tables, translate the physical page ID to a virtual page ID.  <br /></td></tr>
<tr class="separator:ga51602d6eff020251832042618d493ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga448c7722206ca064de59cbe2431f349e" id="r_ga448c7722206ca064de59cbe2431f349e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga448c7722206ca064de59cbe2431f349e">mmu_switch_context</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context)</td></tr>
<tr class="memdesc:ga448c7722206ca064de59cbe2431f349e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch to the given context.  <br /></td></tr>
<tr class="separator:ga448c7722206ca064de59cbe2431f349e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa18eb0616187816f8168f019db521b8" id="r_gaaa18eb0616187816f8168f019db521b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gaaa18eb0616187816f8168f019db521b8">mmu_page_map</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context, int virtpage, int physpage, int count, int prot, int cache, int share, int dirty)</td></tr>
<tr class="memdesc:gaaa18eb0616187816f8168f019db521b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the given virtual page to map to the given physical page.  <br /></td></tr>
<tr class="separator:gaaa18eb0616187816f8168f019db521b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb49f02b9c3421c3db648983eac56b6f" id="r_gacb49f02b9c3421c3db648983eac56b6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gacb49f02b9c3421c3db648983eac56b6f">mmu_copyin</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context, <a class="el" href="group__system__types.html#ga4b435a49c74bb91f284f075e63416cb6">uint32</a> srcaddr, <a class="el" href="group__system__types.html#ga4b435a49c74bb91f284f075e63416cb6">uint32</a> srccnt, void *buffer)</td></tr>
<tr class="memdesc:gacb49f02b9c3421c3db648983eac56b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a chunk of data from a process' address space into a kernel buffer, taking into account page mappings.  <br /></td></tr>
<tr class="separator:gacb49f02b9c3421c3db648983eac56b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac159acf73a24f4a7cdada65b31b04616" id="r_gac159acf73a24f4a7cdada65b31b04616"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gac159acf73a24f4a7cdada65b31b04616">mmu_copyv</a> (<a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context1, struct <a class="el" href="structiovec.html">iovec</a> *iov1, int iovcnt1, <a class="el" href="structmmucontext__t.html">mmucontext_t</a> *context2, struct <a class="el" href="structiovec.html">iovec</a> *iov2, int iovcnt2)</td></tr>
<tr class="memdesc:gac159acf73a24f4a7cdada65b31b04616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a chunk of data from one process' address space to another process' address space, taking into account page mappings.  <br /></td></tr>
<tr class="separator:gac159acf73a24f4a7cdada65b31b04616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac88e46560cb86b0e759c6c51c32b4cd9" id="r_gac88e46560cb86b0e759c6c51c32b4cd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mmu.html#ga85804e94e2c6f22c8d1d1f2c216ba0d1">mmu_mapfunc_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gac88e46560cb86b0e759c6c51c32b4cd9">mmu_map_get_callback</a> (void)</td></tr>
<tr class="memdesc:gac88e46560cb86b0e759c6c51c32b4cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current mapping function.  <br /></td></tr>
<tr class="separator:gac88e46560cb86b0e759c6c51c32b4cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0fe62887a4c714ac9c7e6db0b7c67c1e" id="r_ga0fe62887a4c714ac9c7e6db0b7c67c1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__mmu.html#ga85804e94e2c6f22c8d1d1f2c216ba0d1">mmu_mapfunc_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga0fe62887a4c714ac9c7e6db0b7c67c1e">mmu_map_set_callback</a> (<a class="el" href="group__mmu.html#ga85804e94e2c6f22c8d1d1f2c216ba0d1">mmu_mapfunc_t</a> newfunc)</td></tr>
<tr class="memdesc:ga0fe62887a4c714ac9c7e6db0b7c67c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a new MMU mapping handler.  <br /></td></tr>
<tr class="separator:ga0fe62887a4c714ac9c7e6db0b7c67c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8fea2a954713027b1a67b60380ab41d8" id="r_ga8fea2a954713027b1a67b60380ab41d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga8fea2a954713027b1a67b60380ab41d8">mmu_init</a> (void)</td></tr>
<tr class="memdesc:ga8fea2a954713027b1a67b60380ab41d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize MMU support.  <br /></td></tr>
<tr class="separator:ga8fea2a954713027b1a67b60380ab41d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa86f8c70fd4601477a2c6c88daa944b4" id="r_gaa86f8c70fd4601477a2c6c88daa944b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gaa86f8c70fd4601477a2c6c88daa944b4">mmu_shutdown</a> (void)</td></tr>
<tr class="memdesc:gaa86f8c70fd4601477a2c6c88daa944b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shutdown MMU support.  <br /></td></tr>
<tr class="separator:gaa86f8c70fd4601477a2c6c88daa944b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabffee0d7e91dab25c7453f55640752b6" id="r_gabffee0d7e91dab25c7453f55640752b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gabffee0d7e91dab25c7453f55640752b6">mmu_reset_itlb</a> (void)</td></tr>
<tr class="memdesc:gabffee0d7e91dab25c7453f55640752b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset ITLB.  <br /></td></tr>
<tr class="separator:gabffee0d7e91dab25c7453f55640752b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadaa1f70d1e92ed042a002b9c3e84222f" id="r_gadaa1f70d1e92ed042a002b9c3e84222f"><td class="memItemLeft" align="right" valign="top">mmu_token_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#gadaa1f70d1e92ed042a002b9c3e84222f">mmu_disable</a> (void)</td></tr>
<tr class="memdesc:gadaa1f70d1e92ed042a002b9c3e84222f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporarily disable MMU address translation.  <br /></td></tr>
<tr class="separator:gadaa1f70d1e92ed042a002b9c3e84222f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga33b30063f7fb61a46b267c50eb8438cd" id="r_ga33b30063f7fb61a46b267c50eb8438cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mmu.html#ga33b30063f7fb61a46b267c50eb8438cd">mmu_restore</a> (mmu_token_t token)</td></tr>
<tr class="memdesc:ga33b30063f7fb61a46b267c50eb8438cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restore MMU address translation.  <br /></td></tr>
<tr class="separator:ga33b30063f7fb61a46b267c50eb8438cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Memory Management Unit and Translation Lookaside Buffer handling. </p>
<p>This file defines the interface to the Memory Management Unit (MMU) in the SH4. The MMU, while not used normally by KOS, is available for virtual memory use, if you so desire. While using this functionality is probably overkill for most homebrew, there are a few very interesting things that this functionality could be used for (like mapping large files into memory that wouldn't otherwise fit).</p>
<p>The whole system is set up as a normal paged memory virtual-&gt;physical address translation. KOS implements the page table as a sparse, two-level page table. By default, pages are 4KB in size. Each top-level page table entry has 512 2nd level entries (there are 1024 entries in the top-level entry). This works out to about 2KB of space needed for one top-level entry.</p>
<p>The SH4 itself has 4 TLB entries for instruction fetches, and 64 "unified" TLB entries (for combined instructions + data). Essentially, the UTLB acts both as the TLB for data accesses (from mov instructions) and as a cache for entries for the ITLB. If there is no entry in the ITLB for an instruction access, the UTLB will automatically be searched. If no entry is found still, an ITLB miss exception will be generated. Data accesses are handled similarly to this (although additional complications are involved due to write accesses, and of course the ITLB doesn't play into data accesses).</p>
<p>For more information about how the MMU works, refer to the Hitachi/Renesas SH4 programming manual. It has much more detailed information than what is in here, for obvious reasons.</p>
<p>This functionality was ported over to mainline KOS from the KOS-MMU project of Megan Potter. Unfortunately, KOS-MMU never reached a real phase of maturity and usefulness, but this piece can be quite useful on its own.</p>
<dl class="section author"><dt>Author</dt><dd>Megan Potter </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4944d4b6e4f2b102060cb6e71cd15945" name="a4944d4b6e4f2b102060cb6e71cd15945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4944d4b6e4f2b102060cb6e71cd15945">&#9670;&#160;</a></span>MMU_PAGES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MMU_PAGES&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The number of sub-contexts in the main level context. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_4a04b9aac4eefdd334a78e565f4616f2.html">arch</a></li><li class="navelem"><a class="el" href="dir_49fbd9c46ac73fe76d8a6b686de400da.html">dreamcast</a></li><li class="navelem"><a class="el" href="dir_08ece2ffab5ad20e41852b4cf81b30e2.html">include</a></li><li class="navelem"><a class="el" href="dir_1d647ea94e307d9b0b2b0f182aee406d.html">arch</a></li><li class="navelem"><a class="el" href="mmu_8h.html">mmu.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
